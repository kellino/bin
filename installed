#!/usr/bin/sh

now=$(date)
yaourt=$(which yaourt)
ag=$(which ag)
rclone=$(which rclone)
installed=/tmp/installed.md

localBin() {
    for f in /usr/local/bin/* ; do
        echo "${f}"
    done  
    for f in ~/.cabal/share/doc/x86_64-linux-ghc-7.10.3/* ; do
        echo "${f}"
    done 
}

printTitle() {
    printf "**Installed Software %s**\n\n" "$now" > "$installed"
}

set -e
printTitle
if [ -x "$yaourt" ] && [ -x "$ag" ]; then
    { yaourt -Qe | ag -vi core; 
        localBin; } >> "$installed"
else
    echo "yaourt not installed"
fi

if [ -x "$rclone" ]; then
    rclone copy "$installed" gdrive:docs && echo "successfully transferred to google drive.." && rm "$installed" &&
    echo ".. and removed from ~/Documents"
else
    echo "unable to transfer file"
fi

